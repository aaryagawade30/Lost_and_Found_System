<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard - Lost & Found</title>
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style.css') }}"
    />
  </head>
  <body>
    <div class="nav">
      <h2>Hello, {{ name }}</h2>
      <div>
        <a href="{{ url_for('add_item') }}">+ Add Item</a>
        <a href="{{ url_for('logout') }}">Logout</a>
      </div>
    </div>

    <div class="container">
      <h2>All Reported Items</h2>

      <!-- Search and Filter Form -->
      <form method="POST" class="search-form">
        <input
          type="text"
          name="search"
          placeholder="Search by title, location..."
          class="search-input"
        />
        <select name="category" class="filter-select">
          <option value="All">All</option>
          <option value="Lost">Lost</option>
          <option value="Found">Found</option>
        </select>
        <button type="submit">Search</button>
      </form>

      {% if items %}
        {% for item in items %}
          <div class="card">
            <h3>{{ item.title }} ({{ item.category }})</h3>
            <p>{{ item.description }}</p>
            <p><b>Location:</b> {{ item.location }}</p>
            <p><b>Date:</b> {{ item.date_reported }}</p>
            
            {% if item.image_path %}
              <img 
                src="{{ url_for('static', filename=item.image_path) }}" 
                width="200" 
                alt="Item image"
              >
            {% endif %}
            
            {% if item.user_id == session['id'] %}
              <form
                method="POST"
                action="{{ url_for('delete_item', item_id=item.id) }}"
                onsubmit="return confirm('Are you sure you want to delete this item?');"
              >
                <button type="submit" class="delete-btn">Delete</button>
              </form>
            {% endif %}
          </div>
        {% endfor %}
      {% else %}
        <p>No items found matching your search.</p>
      {% endif %}
    </div>
  </body>
</html>
